<div id="masolatok_oldal-splash" style="display: none;">
  <h2>Másolatok Boltja</h2>
  <p>Válogass a portékáim között, vagy add el a saját másolataidat. Ha elég bátor vagy, vidd játékba a másolatod, és szerezz akár egy vagyont!</p>
  <button class="btn" onclick="markPageAsSeen('masolatok_oldal')">Értettem, mehet!</button>
</div>

<div id="masolatok_oldal-content" style="display: none; position: relative;">
    
    <div class="info-icon-container" title="Információ megjelenítése">
        <i class="fas fa-info-circle" onclick="showSplash('masolatok_oldal')"></i>
    </div>

    <div class="page-container">
        
        <div class="page-section">
            <h3 style="color: var(--color-accent); border-bottom: 1px solid var(--color-accent);">Eladó Másolatok</h3>
            <div class="form-group">
                <label for="elado-masolat-lista" style="font-weight: bold;">Válassz egy másolatot:</label>
                <select id="elado-masolat-lista"></select>
            </div>
            
            <div id="buy-copy-section" style="display: none; margin-top: 15px; padding: 15px; background: #fff; border: 1px solid #ddd; border-radius: 5px;">
                <div id="buy-copy-selection-details" style="margin-bottom: 15px; font-size: 0.95em;"></div>
                <div class="form-group">
                    <label for="buy-copy-pin-code">PIN kód a vásárláshoz:</label>
                    <input type="password" id="buy-copy-pin-code" placeholder="PIN kódod">
                </div>
                <button id="buy-copy-btn" class="btn">Megveszem</button>
            </div>
        </div>

        <div class="page-section" style="padding: 0; overflow: hidden;">
            <button class="accordion-button">Saját Másolataid</button>
            <div class="accordion-panel">
                <div class="accordion-panel-content" id="sajat-masolat-lista-content"> 
                    <div id="sajat-masolat-lista-loader"><p>Keresés...</p></div>
                </div>
            </div>
        </div>

        <div class="page-section" style="padding: 0; overflow: hidden; margin-top: 15px;">
            <button class="accordion-button">Térképek Másolása</button>
            <div class="accordion-panel"> 
                <div class="accordion-panel-content">
                    <p style="font-size: 0.9em; margin-bottom: 10px;">Itt készíthetsz másolatot a már létező térképekről. A másolás díja 30 kredit.</p>
                    <div id="available-maps-list-content"> 
                        <div id="available-maps-list-loader"><p>Másolható térképek betöltése...</p></div>
                    </div>
                    
                    <div class="form-group" style="margin-top: 15px;">
                        <label for="copy-map-pin" style="display: none;">PIN kód a másoláshoz:</label>
                        <div style="position: relative; display: flex; align-items: center;">
                            <input type="password" id="copy-map-pin" placeholder="PIN kódod" style="display: none;">
                            <span onclick="togglePinVisibility('copy-map-pin')" style="position: absolute; right: 8px; cursor: pointer; color: #888;">
                                <i class="fas fa-eye"></i>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="page-section" style="padding: 0; overflow: hidden;">
            
            <!-- Floating GameMaster NPC Button -->
            <div onclick="openUniversalNPC('gamemaster', {
                name: 'Játékmester',
                role: 'Sors és játékvezető',
                icon: '<i class=\'fas fa-chess-knight\'></i>',
                headerColor: '#9c27b0',
                portrait: 'https://img.index.hu/imgfrm/2/5/4/1/THM_0000922541.jpg',
                msgIcon: '<i class=\'fas fa-chess-knight\' style=\'color:#fff; margin-right:5px;\'></i>',
                loaderHTML: '<i class=\'fas fa-chess-knight fa-spin\' style=\'color:#fff; margin-right:8px;\'></i> <i>A Játékmester gondolkodik...</i>',
                styles: {
                    modal: {
                        justifyContent: 'flex-end',
                        alignItems: 'stretch',
                        background: '',
                        padding: '0'
                    },
                    content: {
                        width: '350px',
                        height: '100vh',
                        maxWidth: '85vw',
                        margin: '0',
                        borderRadius: '2',
                        border: 'none',
                        borderLeft: '5px solid #9c27b0',
                        backgroundColor: '#1e1e1e',
                        color: '#fff',
                        backgroundImage: 'https://www.transparenttextures.com/patterns/wood-pattern.png',
                        boxShadow: '-10px 0 30px rgba(0,0,0,0.5)'
                    }
                }
            })"
            title="Játékmester"
            style="position: fixed; bottom: 20px; right: 20px; width: 65px; height: 65px; background: #9c27b0; border: 3px solid #fff; border-radius: 50%; box-shadow: 0 4px 15px rgba(0,0,0,0.4); z-index: 100; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: transform 0.2s;">
                <div style="position: relative;">
                    <i class="fas fa-chess-knight" style="font-size: 2em; color: white;"></i>
                    <i class="fas fa-user-tie" style="position: absolute; bottom: -5px; right: -8px; font-size: 1em; background: #333; color: #fff; border-radius: 50%; padding: 3px; border: 1px solid white;"></i>
                </div>
            </div>
            <div class="accordion-panel">
                <div class="accordion-panel-content" id="sajat-masolat-lista-content"> 
                    <div id="sajat-masolat-lista-loader"><p>Keresés...</p></div>
                </div>
            </div>
        </div>

    </div>

    <div id="gamemaster-modal" class="page-section" 
     style="display: none; position: fixed; top: 0; right: 0; width: 340px; height: 100%; 
            margin: 0; border-radius: 0; border-left: 4px solid #9c27b0; 
            z-index: 2002; padding: 0; flex-direction: column; 
            box-shadow: -10px 0 30px rgba(0,0,0,0.9); background-color: #121212;">
        <div style="background: #9c27b0; color: #fff; padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #fff;">
            <span style="font-family: var(--font-serif); font-size: 1.2em; font-weight: bold;">
                <i class="fas fa-chess-knight"></i> Játékmester
            </span>
            <button onclick="closeGameMasterChat()" style="background: transparent; border: none; color: #fff; font-size: 1.5em; cursor: pointer;">&times;</button>
        </div>

        <div id="gamemaster-chat-box" style="flex: 1; padding: 15px; overflow-y: auto; background-color: #1e1e1e; display: flex; flex-direction: column; gap: 12px;">
        </div>

        <div style="padding: 15px; background: #fff; border-top: 1px solid #9c27b0; min-height: 70px; display: flex; gap: 8px; align-items: center;">
            <input type="text" id="gamemaster-input" placeholder="Válasz a sorsnak..." 
                  style="flex: 1; padding: 10px; border-radius: 4px; border: 1px solid #9c27b0; background: #fff; color: #9c27b0; outline: none;">
            <button class="btn" onclick="sendGameMasterMessage()" 
                    style="background: #9c27b0; color: #fff; border: none; padding: 0 15px; height: 38px; border-radius: 4px; cursor: pointer;">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>

        <input type="hidden" id="active-copy-code-for-gm">
    </div>

    <div id="navigation" style="text-align: center; margin: 20px 0;">
        <button class="btn btn-secondary" onclick="loadPage('kikoto_oldal')">Vissza a Kikötőbe</button>
        <button class="btn btn-danger" onclick="logout()">Kijelentkezés</button>
    </div>
</div>
