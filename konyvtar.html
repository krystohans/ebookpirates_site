<div id="konyvtar-splash" style="display: none;">
  <h2 data-lang="library_splash_title">Könyvtárszoba</h2>
  <p data-lang="library_splash_body">Itt vannak az olvasmányaid, ezen a helyen rejtegeted a titkos térképeidet. Csak sikeres küldetést végrehajtott kapitányok rajzolhatnak új kincses térképeket, így ezek majdnem olyan ritkák, mint a kristálykönyvek. Az értékük meg talán még azoknál is nagyobbak. Persze sok másik térkép is van, közönséges hajóutakkal és útleírásokkal, a legtöbben valami ilyesmit akarnak rád sózni kincses térképnek titulálva azt. Nézd át őket alaposan, hátha újabb titkát tárja fel valamelyik!  Kellemes időtöltést!</p>
  <button class="btn" onclick="markPageAsSeen('konyvtar')" data-lang="library_splash_ack_button">Értettem, mehet!</button>
</div>

<div id="konyvtar-content" style="display: none; position: relative;">
  <div class="info-icon-container" title="Információ megjelenítése" data-lang-title="info_show_title">
    <i class="fas fa-info-circle" onclick="showSplash('konyvtar')"></i>
  </div>

  <div class="page-container">

    <div style="text-align: right; margin-bottom: 15px;">
        <button id="upload-map-button" class="btn" style="display: none;" data-lang="library_upload_map_button">Új térkép feltöltése</button>
    </div>

    <div class="page-section" style="padding: 0; overflow: hidden;">
      <button class="accordion-button" data-lang="library_downloads_title">Letölthető Könyveid</button>
      <div class="accordion-panel">
        <div class="accordion-panel-content" id="konyvtar-books-content">
          <p data-lang="library_books_loading">Betöltés...</p>
        </div>
      </div>
    </div>

    <div class="page-section" style="padding: 0; overflow: hidden; margin-top: 15px;">
      <button class="accordion-button" data-lang="library_copies_title">Olvasható Másolataid</button>
      <div class="accordion-panel">
        <div class="accordion-panel-content" id="konyvtar-copies-content">
          <p data-lang="library_copies_loading">Betöltés...</p>
        </div>
      </div>
    </div>

    <div class="page-section" style="padding: 0; overflow: hidden; margin-top: 15px;">
      <button class="accordion-button" data-lang="library_scrolls_title">Megszerzett Tekercseid</button>
      <div class="accordion-panel">
        <div class="accordion-panel-content" id="konyvtar-scrolls-content">
          <p data-lang="library_scrolls_loading">Betöltés...</p>
        </div>
      </div>
    </div>

    <div class="page-section" style="padding: 0; overflow: hidden; margin-top: 15px;">
      <button class="accordion-button" data-lang="library_maps_title">Saját Térképeid</button>
      <div class="accordion-panel">
        <div class="accordion-panel-content" id="konyvtar-maps-content">
          <p data-lang="library_maps_loading">Betöltés...</p>
        </div>
      </div>
    </div>

    <div class="page-section" style="padding: 0; overflow: hidden; margin-top: 15px;">
      <button class="accordion-button" data-lang="library_logs_title">Olvasható Hajónaplóim</button>
      <div class="accordion-panel">
        <div class="accordion-panel-content" id="konyvtar-logs-content"> 
            <p data-lang="library_logs_loading">Hajónaplók betöltése...</p>
        </div>
      </div>
    </div>

  </div>

  <div id="upload-map-modal" class="gamemode-modal">
      <div class="gamemode-modal-content">
          <button class="btn btn-close" onclick="document.getElementById('upload-map-modal').style.display='none'">X</button>
          <h4 data-lang="library_upload_title">Új Térkép Feltöltése</h4>
          <p style="font-size: 0.9em; margin-bottom: 15px;" data-lang="library_upload_note">Csak PNG formátum engedélyezett!</p>
          
          <div class="form-group">
              <label for="map-identifier" data-lang="library_upload_identifier_label">Térkép Azonosító:</label>
              <input type="text" id="map-identifier" placeholder="Pl. koponya_sziget (ékezetek nélkül)" data-lang-placeholder="library_upload_identifier_placeholder">
          </div>
          <div class="form-group">
              <label for="map-file" data-lang="library_upload_file_label">Képfájl kiválasztása:</label>
              <input type="file" id="map-file" accept="image/png">
          </div>
          
          <button id="submit-map-upload-btn" class="btn" data-lang="library_upload_submit_button">Feltöltés</button>
          <div id="upload-status" style="margin-top: 10px; font-weight: bold;"></div>
      </div>
  </div>

  <div id="map-viewer-modal" style="display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.9); justify-content: center; align-items: center;">
    <div class="map-viewer-container" style="position: relative; width: 95%; height: 95%; background-color: #333; border: 2px solid #aaa; border-radius: 8px; overflow: hidden;">
        <div class="map-viewer-image-wrapper">
            <img id="map-viewer-image" src="" alt="Térkép">
        </div>
        <div class="map-viewer-controls" style="position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.7); padding: 5px 10px; border-radius: 5px;">
            <button id="zoom-in-btn" class="btn btn-secondary" style="padding: 5px 10px;">+</button>
            <button id="zoom-out-btn" class="btn btn-secondary" style="padding: 5px 10px;">-</button>
            <button id="reset-zoom-btn" class="btn btn-secondary" style="padding: 5px 10px;" data-lang="library_map_reset_button">Alap</button>
        </div>
        <button class="map-viewer-close-btn" onclick="closeMapViewer()" style="position: absolute; top: 10px; right: 10px; background: #c82333; color: white; border-radius: 50%; width: 40px; height: 40px; font-size: 20px; border: none; cursor: pointer;">&times;</button>
    </div>
  </div>

  <div id="navigation" style="text-align: center; margin: 20px 0;">
    <button class="btn btn-danger" onclick="logout()" data-lang="library_logout_button">Kijelentkezés</button>
  </div>

<div id="konyvtar-container">
    <div id="reader-modal" style="display: none;">
        <div class="reader-container">
            <div class="text-shield" id="reader-shield"></div>
            <div class="content-display" id="reader-content-display"></div>
            <button class="reader-close-btn" onclick="document.getElementById('reader-modal').style.display='none'" data-lang="library_reader_close_button">Bezárás</button>
        </div>
    </div>
</div>

</div>